# sys-echo

## üìù –£—Å–ª–æ–≤–∏–µ

–ù–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É `solution02_05.s` (—Å–∏–Ω—Ç–∞–∫—Å–∏—Å **Intel**) –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ C, –∫–æ—Ç–æ—Ä–∞—è:

- —á–∏—Ç–∞–µ—Ç —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –≤–≤–æ–¥–∞ **–¥–æ 64 –±–∞–π—Ç** –æ–¥–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π;
- –µ—Å–ª–∏ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ —Ö–æ—Ç—è –±—ã 1 –±–∞–π—Ç, –ø–µ—á–∞—Ç–∞–µ—Ç —Å—Ç—Ä–æ–∫—É:
  ```
  ECHO: <–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ_–±–∞–π—Ç—ã>
  ```
  –≥–¥–µ `<–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ_–±–∞–π—Ç—ã>` ‚Äî —Ä–æ–≤–Ω–æ —Ç–æ, —á—Ç–æ –≤–µ—Ä–Ω—É–ª `read` (–≤–∫–ª—é—á–∞—è `\n`, –µ—Å–ª–∏ –æ–Ω –±—ã–ª –≤–æ –≤—Ö–æ–¥–µ);
- –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –∫–æ–¥–æ–º `0`.

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã Linux x86-64: `read`, `write`, `exit`, –≤—ã–∑—ã–≤–∞—è –∏—Ö —á–µ—Ä–µ–∑ –æ–±—ë—Ä—Ç–∫—É `asm/syscall.S` ([–∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ —Ñ–∞–π–ª–∞](../../../asm/syscall.S)).

## ‚ÑπÔ∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

- –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤: `SYS_read = 0`, `SYS_write = 1`, `SYS_exit = 60`.
- –°–∏–≥–Ω–∞—Ç—É—Ä–∞ –æ–±—ë—Ä—Ç–∫–∏:
    - `extern syscall` (SysV ABI):
        - –Ω–∞ –≤—Ö–æ–¥: `rdi = sysno`, `rsi = arg1`, `rdx = arg2`, `rcx = arg3`, `r8 = arg4`, `r9 = arg5`;
        - –Ω–∞ –≤—ã—Ö–æ–¥: `rax` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
- –†–∞–∑–º–µ—Å—Ç–∏—Ç–µ –±—É—Ñ–µ—Ä (64 –±–∞–π—Ç–∞) –≤ `.bss`, —Å—Ç—Ä–æ–∫—É –ø—Ä–µ—Ñ–∏–∫—Å–∞ `ECHO: ` ‚Äî –≤ `.rodata`, –∫–æ–¥ ‚Äî –≤ `.text`.
- –ü—Ä–æ–≥—Ä–∞–º–º–∞ **–Ω–µ** –¥–æ–ª–∂–Ω–∞ –≤—ã–∑—ã–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (`printf`, `scanf`, ‚Ä¶).
- –°–∏–Ω—Ç–∞–∫—Å–∏—Å –∞—Å—Å–µ–º–±–ª–µ—Ä–∞ —É–∫–∞–∂–∏—Ç–µ –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞:
  ```asm
  .intel_syntax noprefix
  ```

## ‚öôÔ∏è –ë—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç—ã

```bash
cd hw/lab02/05_sys_echo     # –ø–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É –∑–∞–¥–∞—á–∏
make                        # —Å–±–æ—Ä–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã (–ª–∏–Ω–∫–æ–≤–∫–∞ —Å asm/syscall.S)
make run                    # —Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
make test                   # –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã (unittest)
```

## üß™ –ü—Ä–∏–º–µ—Ä—ã –≤–≤–æ–¥–∞ –∏ –≤—ã–≤–æ–¥–∞

| –í–≤–æ–¥            | –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥     |
|-----------------|---------------------|
| `hello\n`       | `ECHO: hello\n`     |
| `ABC\n`         | `ECHO: ABC\n`       |
| `xyz`           | `ECHO: xyz`         |
| *(EOF / –ø—É—Å—Ç–æ)* | *(–ø—É—Å—Ç–æ–π –≤—ã–≤–æ–¥)*    |

## üê≥ –†–∞–±–æ—Ç–∞ –≤ Docker

### 1. –°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–∞

```bash
docker build -t dev-intel .
```

### 2. –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
docker run -it --rm -v "$(pwd)":/workspace -w /workspace dev-intel
```

### 3. –°–±–æ—Ä–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
cd hw/lab02/05_sys_echo
make
make test
```

### 4. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
exit
```
–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ `Ctrl + D`.

## üßπ –û—á–∏—Å—Ç–∫–∞

```bash
make clean
```

## üöÄ –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã –≤ GitHub Actions

```bash
git add .
git commit -m "lab02: sys-echo"
git push   # —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—è–≤–∏—Ç—Å—è –≤ Actions ‚úÖ
```
